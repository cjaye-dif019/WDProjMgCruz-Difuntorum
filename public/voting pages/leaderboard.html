<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name = "description" content="Pillars of Excellence; a website dedicated to the teachers of PSHS-MC.">
    <meta name="keywords" content="Pillars of Excellence">
    <meta name="author" content="SCA Cruz & CJA Difuntorum">

    <title>Voting Page - Best Energy in Class</title>
    <script src = "../../java/unit.js" defer></script>
    <script src="../../java/teacher_name.js"></script>
    <script src="../../java/voting_year.js"></script>
    <script src="../../java/votecollection.js"></script>
    <link rel="stylesheet" href="../../css/leaderboard.css">
        <link rel="stylesheet" href="../../css/headerfooter.css">

    <link rel="icon" href = "../../readme images/logo.png" type="image/png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700;800&display=swap" rel="stylesheet">

</head>


</head>

<body>

    <header>
        <div class="logo-title">
        <img src="../../readme images/logo.png" />
            <div>
                <div style="font-size: 26px; font-weight: bold;">Pillars of Excellence</div>
                <div style="font-family: 'Montserrat';">Teachers of Pisay</div>
            </div>
        </div>

        <div class="menu" onclick="toggleMenu()">☰</div>
    </header>

    <!-- menu -->
    <div id="menuDropdown" class="nav-menu">
        <a href="../../main_page.html">Home Page</a>
        <a href="../public/teachers.html">Teachers' Page</a>
        <a href="../public/voting.html">Vote for Teacher</a>
        <a href="../public/leaderboard.html">Leaderboard</a>
    </div>

      <!-- best overall -->
  <div class="section_special">
    <div class="section-title">BEST OVERALL</div>
    <div id="bestOverall"></div>
  </div>
<div class="container">



  <!-- per category -->
  <div class="section">
    <div class="section-title">TITO OF PISAY</div>
    <div id="tito"></div>
  </div>

  <div class="section">
    <div class="section-title">TITA OF PISAY</div>
    <div id="tita"></div>
  </div>


  <div class="section">
    <div class="section-title">BEST ENERGY IN CLASS</div>
    <div id="energyinclass"></div>
  </div>
  <div class="section">
    <div class="section-title">BEST HANDWRITING</div>
    <div id="handwriting"></div>
  </div>
  <div class="section">
    <div class="section-title">BEST LECTURER</div>
    <div id="lecturer"></div>
  </div>
  <div class="section">
    <div class="section-title">BEST STORYTELLER</div>
    <div id="storyteller"></div>
  </div>
  <div class="section">
    <div class="section-title">BEST TEST DESIGNER</div>
    <div id="testdesigner"></div>
  </div>
  <div class="section">
    <div class="section-title">MOST APPROCHABLE</div>
    <div id="approachable"></div>
  </div>
  <div class="section">
    <div class="section-title">MOST FASHIONABLE</div>
    <div id="fashionable"></div>
  </div>
  <div class="section">
    <div class="section-title">MOST INSPIRING</div>
    <div id="inspiring"></div>
  </div><div class="section">
    <div class="section-title">MOST ORGANIZED</div>
    <div id="organized"></div>
  </div><div class="section">
    <div class="section-title">MOST PASSIONATE ABOUT TEACHING</div>
    <div id="passionateaboutteaching"></div>
  </div><div class="section">
    <div class="section-title">MOST PATIENT</div>
    <div id="patient"></div>
  </div><div class="section">
    <div class="section-title">MOST RELATABLE</div>
    <div id="relatable"></div>


</div>


<footer>
        <div>
            Pillars of Excellence<br>© SCA CRUZ & CJA DIFUNTORUM
        </div>

        <div class="footer-icons">
            <img src="https://cdn-icons-png.flaticon.com/512/733/733547.png">
            <img src="https://cdn-icons-png.flaticon.com/512/733/733558.png">
            <img src="https://cdn-icons-png.flaticon.com/512/733/733579.png">
        </div>

        <div>
            Contact: 01234567890<br>
            Emails: b2029scacruz@pshs.edu.ph | b2029cjadifuntorum@pshs.edu.ph
        </div>
</footer>

<script src="teacher_name.js"></script>
<script src="voting_year.js"></script>
<script>


 function toggleMenu() {
            const menu = document.getElementById("menuDropdown");
            menu.style.display = menu.style.display === "flex" ? "none" : "flex";
        }

const data = JSON.parse(localStorage.getItem("categoryVotes")) || {};
const CATEGORY = "TITO OF PISAY";

function getOverallWinners(limit = 5){
  const totals = {};

  if(!data[CATEGORY]) return [];

  Object.values(data[CATEGORY]).forEach(subject=>{
    Object.entries(subject).forEach(([teacher, count])=>{
      totals[teacher] = (totals[teacher] || 0) + count;
    });
  });

  return Object.entries(totals)
    .sort((a,b)=>b[1]-a[1])
    .slice(0,limit);

    
}

/* overall best*/
const overallDiv = document.getElementById("bestOverall");
const overall = getOverallWinners();

if(overall.length === 0){
  overallDiv.innerHTML = "<p>No votes yet.</p>";
}else{
  overall.forEach((t,i)=>{
    overallDiv.innerHTML += `
      <div class="rank">
        ${i+1}. ${t[0]} 
      </div>`;
  });
}

/*per category best*/
function renderCategory(categoryName, containerId){
  const container = document.getElementById(containerId);

  if(!data[categoryName]){
    container.innerHTML = "<p>No votes yet.</p>";
    return;
  }

  const years = ["FYP","AYP","SYP","FYP & SYP","FYP & AYP","AYP & SYP"];

  years.forEach(year => {

    let yearVotes = {};

    Object.entries(data[categoryName]).forEach(([subject, teachers])=>{
      Object.entries(teachers).forEach(([teacher, votes])=>{

        if(teacherYear[teacher] === year){
          if(!yearVotes[teacher]){
            yearVotes[teacher] = {
              votes: 0,
              subject: subject.replace(/_/g," ")
            };
          }
          yearVotes[teacher].votes += votes;
        }

      });
    });

    const sorted = Object.entries(yearVotes)
      .sort((a,b)=>b[1].votes - a[1].votes)
      .slice(0,5);

    if(sorted.length === 0) return;

    container.innerHTML += `
      <div class="subject-title">${year} TEACHERS</div>
    `;

    sorted.forEach((t,i)=>{
      container.innerHTML += `
        <div class="rank">
          ${i+1}. ${t[0]} (${t[1].subject})
        </div>
      `;
    });

  });
}


renderCategory("TITO OF PISAY", "tito");
renderCategory("TITA OF PISAY", "tita");
renderCategory("BEST ENERGY IN CLASS", "energyinclass");
renderCategory("BEST HANDWRITING", "handwriting");
renderCategory("BEST LECTURER", "lecturer");
renderCategory("BEST STORYTELLER", "storyteller");
renderCategory("BEST TEST DESIGNER", "testdesigner");
renderCategory("MOST APPROCHABLE", "approachable");
renderCategory("MOST FASHIONABLE", "fashionable");
renderCategory("MOST INSPIRING", "inspiring");
renderCategory("MOST ORGANIZED", "organized");
renderCategory("MOST PASSIONATE ABOUT TEACHING", "passionateaboutteaching");
renderCategory("MOST PATIENT", "patient");
renderCategory("MOST RELATABLE", "relatable");



</script>

</body>
</html>
